!function(r){"use strict";r(document).ready(function(){var n,e=!1,o=!1;function i(){r("<link/>",{rel:"stylesheet",href:Youzify.assets+"css/youzify-url-preview.min.css"}).appendTo("head"),r("<script/>",{rel:"text/javascript",src:Youzify.assets+"js/youzify-url-preview.min.js"}).appendTo("head")}r(".youzify-wall-form-show-all").on("click",function(e){r(".youzify-wall-form-show-all").fadeOut(function(){r(".youzify-wall-opts-item").fadeIn(),r(this).remove()})}),r(document).on("input click",".youzify-wall-textarea, .ac-input",function(){r(this).next(".youzify-load-emojis").attr("data-cursor",r(this).prop("selectionStart"))}),r(document).on("focus",".youzify-wall-textarea",function(){0==e&&(r(this).closest("form").find(".youzify-lp-prepost").get(0)&&i(),e=!0)}),r(document).on("click",".youzify-edit-tool",function(){0==e&&(r("#youzify-wall-form").find(".youzify-lp-prepost").get(0)&&i(),e=!0)}),r(document).on("click",".youzify-load-emojis",function(){r(this).closest("form");r(this).find("i").attr("class","fas fa-spin fa-spinner"),r(this).addClass("loading"),r("<link/>",{rel:"stylesheet",href:Youzify.assets+"css/youzify-emojionearea.min.css"}).appendTo("head"),r("<script/>",{rel:"text/javascript",src:Youzify.assets+"js/youzify-emojionearea.min.js"}).appendTo("head")}),r(document).on("click",".youzify-wall-post",function(){var e,s=0,n=r(this),l=r(this).text(),f=n.closest("form#youzify-wall-form"),y={};r.each(f.serializeArray(),function(e,i){"_"!==i.name.substr(0,1)&&"whats-new"!==i.name.substr(0,9)&&(y[i.name]?r.isArray(y[i.name])?y[i.name].push(i.value):y[i.name]=new Array(y[i.name],i.value):y[i.name]=i.value)}),f.find("*").each(function(){(r.nodeName(this,"textarea")||r.nodeName(this,"input"))&&r(this).prop("disabled",!0)}),f.find(".youzify-wall-textarea").get(0).Youzify_emojioneArea&&f.find(".youzify-wall-textarea").data("Youzify_emojioneArea").disable(),n.addClass("loading"),n.prop("disabled",!0),f.addClass("submitted"),n.css("min-width",n.css("width")),n.html('<i class="fas fa-spinner fa-spin"></i>');var i="",t=f.find("#whats-new-post-in").val(),a=f.find("#whats-new").val(),d=r("#youzify ul.activity-list li").first(),o=d,u=null;return d.length&&(o.hasClass("load-newest")&&(o=d.next()),u=o.prop("class").match(/date-recorded-([0-9]+)/)),u&&(s=u[1]),0<t&&(i=f.find("#whats-new-post-object").val()),e=r.extend({action:"youzify_post_update",cookie:bp_get_cookies(),_youzify_wpnonce_post_update:r("#_youzify_wpnonce_post_update").val(),content:a,object:i,item_id:t,since:s,_bp_as_nonce:r("#_bp_as_nonce").val()||""},y),r.post(ajaxurl,e,function(e){if(f.find("*").each(function(){(r.nodeName(this,"textarea")||r.nodeName(this,"input"))&&r(this).prop("disabled",!1)}),f.find(".youzify-wall-textarea").get(0).Youzify_emojioneArea&&f.find(".youzify-wall-textarea").data("Youzify_emojioneArea").enable(),0==e.success)r.youzify_DialogMsg("error",e.data.error);else{if(n.html('<i class="fas fa-check"></i>').hide().fadeIn("slow"),f.find(".youzify-delete-attachment").trigger("click"),0===r("ul.activity-list").length&&(r("div.error").slideUp(100).remove(),r("#message").slideUp(100).remove(),r("div.activity").append('<ul id="activity-stream" class="activity-list item-list">')),d.hasClass("load-newest")&&d.remove(),r("#activity-stream").prepend(e),s||r("#activity-stream li:first").addClass("new-update just-posted"),r(e).get(0)&&r("body,html").animate({scrollTop:r("#"+r(e).attr("id")).offset().top-65+"px"},1e3),0!==r("#latest-update").length){var i=r("#activity-stream li.new-update .activity-content .activity-inner p").html(),t=r("#activity-stream li.new-update .activity-content .activity-header p a.view").attr("href"),a=r("#activity-stream li.new-update .activity-content .activity-inner p").text(),o="";""!==a&&(o=i+" "),o+='<a href="'+t+'" rel="nofollow">'+BP_DTheme.view+"</a>",r("#latest-update").slideUp(300,function(){r("#latest-update").html(o),r("#latest-update").slideDown(300)})}r("li.new-update").hide().slideDown(300),r("li.new-update").removeClass("new-update"),r("#whats-new").val(""),"activity_slideshow"==y.post_type&&r.youzify_sliders_init(),f.get(0).reset(),f.find(".youzify-wall-textarea").get(0).Youzify_emojioneArea&&f.find(".youzify-wall-textarea").get(0).Youzify_emojioneArea.setText(""),f.find(".youzify-tagged-user .youzify-tagusers-delete-user, .youzify-list-delete-item, .youzify-list-close-icon").trigger("click"),f.find("div.youzify-activity-privacy").find(".list div").first().trigger("click"),f.find("#whats-new-post-in").find("option").first().trigger("click"),window.hasOwnProperty("youzify_disable_niceselect")||f.find("#whats-new-post-in").niceSelect("update"),r("#whats-new-post-in").trigger("change"),f.find('.youzify-wall-options input:radio[name="post_type"]').first().trigger("change"),f.find(".youzify-lp-prepost .lp-button-cancel").trigger("click"),"activity_giphy"==y.post_type&&(f.find(".youzify-delete-giphy-item").trigger("click"),f.find(".youzify-giphy-submit-search").val("").trigger("click")),"activity_poll"==y.post_type&&(f.find(".youzify-wall-cf-input").val(""),f.find(".youzify-wall-poll-form .youzify-wall-cf-item:not(:nth-child(1)):not(:nth-child(2)) .youzify-wall-form-remove-item").trigger("click")),newest_activities="",activity_last_recorded=0}setTimeout(function(){n.html(l).fadeIn("slow")},1e3),f.find(".youzify-wall-post,.youzify-update-post").prop("disabled",!1).removeClass("loading"),"youzify-share-activity-wrapper"==f.parent().attr("id")&&r(".youzify-modal-close-icon").trigger("click")}),!1}),r(document).on("change",'input:radio[name="post_type"]',function(e){var i=r(this).closest("form"),t=r(this).val(),a=r(this).data("uploader");switch(1<r('input:radio[name="post_type"]').length?0==i.find('.youzify-wall-custom-form[data-post-type!="'+t+'"]').length?i.find('.youzify-wall-custom-form[data-post-type="'+t+'"]').fadeIn():i.find('.youzify-wall-custom-form[data-post-type!="'+t+'"]').fadeOut(1,function(){i.find('.youzify-wall-custom-form[data-post-type="'+t+'"]').fadeIn()}):i.find('.youzify-wall-custom-form[data-post-type="'+t+'"]').fadeIn(),t){case"activity_video":i.find(".youzify-upload-attachments").attr("accept","video/*");break;case"activity_audio":i.find(".youzify-upload-attachments").attr("accept","audio/*");break;case"activity_file":i.find(".youzify-upload-attachments").removeAttr("accept");break;case"activity_poll":o||(r("<script/>",{rel:"text/javascript",src:Youzify.assets+"js/youzify-polls.min.js"}).appendTo("head"),o=!0);break;default:i.find(".youzify-upload-attachments").attr("accept","image/*")}"on"==a?(void 0!==e.originalEvent&&"activity_quote"!=t&&"activity_link"!=t&&"youzify-edit-activity-wrapper"!=i.parent().attr("id")&&i.find(".youzify-wall-actions .youzify-wall-upload-btn").trigger("click"),i.find(".youzify-wall-actions .youzify-wall-upload-btn").fadeIn()):i.find(".youzify-wall-actions .youzify-wall-upload-btn").fadeOut(),i.find('.youzify-wall-custom-form[data-post-type="'+t+'"]').find('input[type="text"]')[0]&&i.find('.youzify-wall-custom-form[data-post-type="'+t+'"]').find('input[type="text"]')[0].focus(),i.find(".youzify-delete-attachment").trigger("click"),i.find(".youzify-attachment-item").remove()}),r('input:radio[name="post_type"]').first().trigger("change"),r(document).on("click",".youzify-wall-upload-btn",function(e){youzify_load_attachments||(r("<script/>",{rel:"text/javascript",src:Youzify.assets+"js/youzify-attachments.min.js"}).appendTo("head"),r("<link/>",{rel:"stylesheet",href:Youzify.assets+"css/youzify-attachments.min.css"}).appendTo("head"),youzify_load_attachments=!0),r(this).closest("form").find(".youzify-wall-attachments .youzify-upload-attachments").click(),e.preventDefault()}),r(document).on("click",".youzify-tag-users-tool",function(){var a=r(this).closest("form");if(a.find(".youzify-feeling-form").fadeOut(),r(this).hasClass("loaded"))return a.find(".youzify-tagusers-form").fadeToggle(),void a.find(".youzify-tagusers-search-input").focus();var o=r(this),s=o.find("i"),n=s.attr("class");s.attr("class","fas fa-spinner fa-spin"),r.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"youzify_tag_users_get_user_friends"},success:function(e){o.addClass("loaded");var i=r("<div></div>").append(e.data);if("youzify-edit-activity-wrapper"==a.parent().attr("id")){var t=[];a.find('input[name="tagged_users[]"]').each(function(){i.find('.youzify-list-item[data-user-id="100"] ').fadeOut(),t.push(r(this).val())}),i.find(".youzify-list-item").each(function(e,i){-1!==jQuery.inArray(r(this).attr("data-user-id"),t)&&r(this).find(".youzify-wall-tag-user").hide()})}a.find(".youzify-tagusers-form").fadeIn(200,function(){s.attr("class",n),a.find(".youzify-tagusers-search-input").focus(),a.find(".youzify-wall-tagusers-list").html(i)})}})}),r(document).on("keyup",".youzify-list-search-input",function(){var e=r(this).closest(".youzify-wall-list"),i=this.value.toLowerCase().trim();e.find(".youzify-wall-list-items .youzify-list-item").show().filter(function(){return-1==r(this).find(".youzify-item-title, .youzify-item-description").text().toLowerCase().trim().indexOf(i)}).hide()}),r(document).on("click",".youzify-user-mood-tool",function(){var i=r(this).closest("form");if(i.find(".youzify-tagusers-form").fadeOut(),r(this).hasClass("loaded"))return i.find(".youzify-feeling-form").fadeToggle(),void i.find(".youzify-feeling-search-input").focus();i.find(".youzify-feeling-form").attr("data-placeholder",i.find(".youzify-feeling-search-input").attr("placeholder"));var t=r(this),a=t.find("i"),o=a.attr("class");a.attr("class","fas fa-spinner fa-spin"),r.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"youzify_feeling_activity_get_categories"},success:function(e){t.addClass("loaded"),i.find(".youzify-feeling-form").fadeIn(200,function(){a.attr("class",o),i.find(".youzify-feeling-search-input").focus(),i.find(".youzify-wall-feeling-list").html(e.data)})}})}),r(document).on("click",".youzify-feeling-item",function(e){e.preventDefault();var i=r(this),t=i.closest(".youzify-wall-feeling");if(r(this).parent().hasClass("youzify-list-category-items"))r.youzify_select_mood_emojis(t,i.attr("data-emoji"),i.attr("data-category-title"),i.find(".youzify-item-img").css("background-image"));else{t.find(".youzify-list-items-title").text(i.attr("data-category-title")),t.find('input[name="mood_type"]').val(i.attr("data-category")),t.find(".youzify-list-categories").fadeOut(),t.find(".youzify-feeling-close-icon").addClass("youzify-feeling-go-back"),t.find(".youzify-feeling-close-icon i").attr("class","far fa-arrow-alt-circle-left"),t.find('input[name="mood_search"]').val("").attr("placeholder",i.find(".youzify-item-description").text()),t.find(".youzify-list-search-icon i").attr("class",i.find(".youzify-item-icon i").attr("class"));var a=t.find('.youzify-list-category-items[data-category="'+r(this).attr("data-category")+'"]');1==a.length?a.fadeIn():t.find(".youzify-list-submit-button").fadeIn()}}),r(document).on("click",".youzify-feeling-close-icon",function(){var e=r(this),i=e.closest(".youzify-wall-feeling");if(i.find(".youzify-feeling-submit-button").fadeOut(),i.find(".youzify-feeling-search-input").val(""),i.find(".youzify-feeling-search-input").attr("placeholder",i.find(".youzify-feeling-form").attr("data-placeholder")),i.find(".youzify-feeling-search-icon i").attr("class","fas fa-search"),e.hasClass("youzify-feeling-go-back"))return e.find("i").attr("class","fas fa-times"),i.find(".youzify-list-categories, .youzify-list-item").fadeIn(),i.find(".youzify-list-category-items").fadeOut(),void e.removeClass("youzify-feeling-go-back");e.closest(".youzify-feeling-form").fadeOut()}),r(document).on("click",".youzify-wall-feeling .youzify-list-edit-item",function(){var e=r(this),i=e.closest(".youzify-wall-feeling"),t=i.find(".youzify-list-selected-items");t.fadeOut(200,function(){i.find(".youzify-feeling-search-input").val(t.find(".youzify-item-title").text()),e.closest(".youzify-selected-item").fadeOut(200,function(){r(this).remove()}),i.find(".youzify-feeling-form").fadeIn(),i.removeClass("youzify-activity-feeling-selected")})}),r(document).on("click",".youzify-wall-feeling .youzify-list-delete-item",function(){var e=r(this),i=e.closest(".youzify-wall-feeling"),t=i.find(".youzify-list-selected-items");t.fadeOut(200,function(){t.find(".youzify-item-title").text(""),e.closest(".youzify-selected-item").fadeOut(200,function(){r(this).remove()}),i.find(".youzify-feeling-close-icon").trigger("click"),i.removeClass("youzify-activity-feeling-selected")})}),r(document).on("click",".youzify-feeling-submit-button",function(){var e=r(this).closest(".youzify-wall-feeling"),i=e.find(".youzify-feeling-search-input").val();""!=i.trim()&&r.youzify_select_mood_emojis(e,i,i)}),r(document).on("keypress",".youzify-feeling-search-input",function(e){if(13==e.keyCode){e.preventDefault();var i=r(this).next(".youzify-feeling-submit-button");"none"!=i.css("display")&&i.click()}}),r.youzify_select_mood_emojis=function(e,i,t,a){e.hasClass("youzify-activity-feeling-selected")&&e.find(".youzify-selected-item").remove(),e.addClass("youzify-activity-feeling-selected"),e.find(".youzify-feeling-form").fadeOut(0,function(){e.find(".youzify-feeling-selected-items").fadeIn()});var o=null==a?"":"<div class='youzify-item-img' style='background-image: "+a+";'></div>",s=null==a?" youzify-selected-item-no-image":"";e.find(".youzify-list-selected-items").append('<div class="youzify-selected-item youzify-feeling-selected-item'+s+'">'+o+'<div class="youzify-item-title">'+t+'</div><i class="fas fa-pencil-alt youzify-selected-item-tool youzify-list-edit-item"></i><i class="fas fa-trash-alt youzify-selected-item-tool youzify-list-delete-item"></i><input type="hidden" name="mood_value" value="'+i+'"></div>').fadeIn(),e.find(".youzify-feeling-search-input").val("")},r(document).on("click",".youzify-wall-tag-user",function(){var t=r(this);if(!t.hasClass("youzify-selected")){t.addClass("youzify-selected");var a=t.closest(".youzify-list-item");r(this).fadeOut(200,function(){var e="<div class=\"youzify-selected-item youzify-tagged-user\"><div class='youzify-item-img' style='background-image: "+a.find(".youzify-item-img").css("background-image")+';\'></div><div class="youzify-item-title">'+a.find(".youzify-item-title").text()+'</div><i class="fas fa-trash-alt youzify-selected-item-tool youzify-list-delete-item youzify-tagusers-delete-user" data-user-id="'+a.attr("data-user-id")+'"></i><input type="hidden" name="tagged_users[]" value="'+a.attr("data-user-id")+'"></div>';a.closest(".youzify-wall-tagusers").find(".youzify-tagged-users").append(e);t.closest(".youzify-wall-tagusers").find(".youzify-tagged-user").length;var i=t.closest(".youzify-wall-tagusers");1==i.find(".youzify-tagged-user").length&&i.find(".youzify-tagged-users").fadeIn()})}}),r(document).on("click",".youzify-list-close-icon.youzify-tagusers-close-icon",function(){r(this).closest(".youzify-tagusers-form").fadeOut()}),r(document).on("click",".youzify-tagusers-delete-user",function(){r(this).parent();var e=r(this).closest(".youzify-wall-tagusers"),i=r(this).closest(".youzify-tagged-users");e.find(".youzify-list-item[data-user-id="+r(this).attr("data-user-id")+"] .youzify-wall-tag-user").removeClass("youzify-selected").fadeIn(),r(this).parent().fadeOut(200,function(){r(this).remove(),0==i.find(".youzify-tagged-user").length&&i.fadeOut()})}),r(document).on("change","#whats-new-post-in",function(e){0!=r(this).val()?r(this).closest(".youzify-wall-actions").find("div.youzify-activity-privacy").fadeOut():r(this).closest(".youzify-wall-actions").find("div.youzify-activity-privacy").fadeIn()}),r(document).on("click",".youzify-send-comment",function(e){if(e.preventDefault(),!r(this).hasClass("loading")){var a,o,i,t,s,n,l,f,y,d,u=r(this);return u.addClass("loading"),d=u.find("i").attr("class"),u.find("i").attr("class","fas fa-spinner fa-spin"),i=(a=u.parents("form")).parent(),s=a.attr("id").split("-"),t=i.hasClass("activity-comments")?s[2]:i.attr("id").split("-")[1],o=r("#"+a.attr("id")+" textarea"),r("#"+a.attr("id")+" div.error").hide(),u.addClass("loading").prop("disabled",!0),o.addClass("loading").prop("disabled",!0),n={action:"new_activity_comment",cookie:bp_get_cookies(),_wpnonce_new_activity_comment:r("#_wpnonce_new_activity_comment").val(),comment_id:t,form_id:s[2],post_type:"activity_comment",content:o.val()},(l=r("#_bp_as_nonce_"+t).val())&&(n["_bp_as_nonce_"+t]=l),r.post(ajaxurl,n,function(i){if(u.removeClass("loading"),o.removeClass("loading"),u.find("i").attr("class",d),i[0]+i[1]==="-1")a.append(r(i.substr(2,i.length)).hide().fadeIn(200));else{var t=a.parent();if(a.fadeOut(200,function(){0===t.children("ul").length&&(t.hasClass("activity-comments")?t.prepend("<ul></ul>"):t.append("<ul></ul>"));var e=r.trim(i);t.children("ul").append(r(e).hide().fadeIn(200)),a.children("textarea").val(""),t.parent().addClass("has-comments")}),r("#"+a.attr("id")+" textarea").val(""),f=Number(r("#activity-"+s[2]+" a.acomment-reply span").html())+1,r("#activity-"+s[2]+" a.acomment-reply span").html(f),y=t.closest(".activity-comments").find(".show-all a")){var e=y.text().match(/\((.*)\)/);e&&y.html(BP_DTheme.show_x_comments.replace("%d",Number(e[1])+1))}}r(u).prop("disabled",!1),r(o).prop("disabled",!1)}),!1}}),r(document).on("keypress",".ac-form textarea",function(e){13!=e.which||e.shiftKey||(e.preventDefault(),r(this).closest("form").find(".youzify-send-comment").click())}),r.youzify_isPostType=function(e,i){return i==e.find('input:radio[name="post_type"]:checked').val()},r(document).on("click",".share-activity",function(e){if(e.preventDefault(),!r(".share-activity.loading")[0]){var o=r(this),i=o.parents("li").attr("id").split("-")[1],s=(o.attr("data-activity-type"),!0);if(!o.hasClass("loading")){o.addClass("loading"),n=o,r("#youzify-edit-activity-wrapper");var t={action:"youzify_get_share_activity_form",youzify_share_activity_nonce:Youzify.security_nonce,activity_id:i};r.post(Youzify.ajax_url,t,function(e){if(0==e.success)return n.remove(),void r.youzify_DialogMsg("error",e.error);var i=r(e.data.form);r("body").append(i.hide());var t=r(e.data.preview);t.insertAfter(i.find("textarea#whats-new")),jQuery.isFunction(r.fn.niceSelect)&&i.find('select:not([multiple="multiple"])').niceSelect(),150<t.height()&&(t.find(".youzify-shared-wrapper-container").addClass("youzify-collapsed-preview"),i.find(".youzify-shared-wrapper").append(e.data.show_all)),i.find("form").append('<input type="hidden" value="activity_share" name="post_type" />'),i.find("form").append('<input type="hidden" value="'+e.data.activity_id+'" name="secondary_item_id" />'),i.find(".youzify-wall-options").remove(),"on"==e.posts_emojis&&(s=!1,jQuery().Youzify_emojioneArea?i.find(".youzify-wall-textarea").Youzify_emojioneArea({pickerPosition:"bottom",autocomplete:!0,saveEmojisAs:"image",events:{ready:function(){this.editor.textcomplete([{id:"youzify_mentions",match:/\B@([\-\d\w]*)$/,search:function(i,e){var t=bp.mentions.users;e(r.map(t,function(e){return 0===e.ID.indexOf(i)||0===e.name.indexOf(i)?e:null}))},template:function(e){return'<img src="'+e.image+'" /><span class="username">@'+e.ID+"</span><small>"+e.name+"</small>"},replace:function(e){return"@"+e.ID+"&nbsp;"},cache:!0,index:1}])}}}):(r("<script/>",{rel:"text/javascript",src:Youzify.assets+"js/youzify-emojionearea.min.js"}).appendTo("head"),r("<link/>",{rel:"stylesheet",href:Youzify.assets+"css/youzify-emojionearea.min.css"}).appendTo("head"))),i.find(".youzify-wall-upload-btn").remove();var a=setInterval(function(){(1==s||0==s&&i.find(".youzify-emojionearea").get(0))&&(clearInterval(a),o.attr("data-loaded","true"),o.removeClass("loading"),r.youzify_show_modal(i))},100)}).fail(function(e,i,t){return o.removeClass("loading"),r.youzify_DialogMsg("error",Youzify.unknown_error),!1})}}}),r(document).on("click",".youzify-show-all-less div",function(){var e=r(this).parent();e.hasClass("active")?(e.removeClass("active"),e.prev(".youzify-shared-wrapper-container").addClass("youzify-collapsed-preview")):(e.addClass("active"),e.prev(".youzify-shared-wrapper-container").removeClass("youzify-collapsed-preview"))})})}(jQuery);